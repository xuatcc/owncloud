\hypertarget{checksums_8cpp}{}\section{bin/\+Debug/test/电信学院/项目1/原版客户端重点查看文件/libsync/checksums.cpp 文件参考}
\label{checksums_8cpp}\index{bin/\+Debug/test/电信学院/项目1/原版客户端重点查看文件/libsync/checksums.\+cpp@{bin/\+Debug/test/电信学院/项目1/原版客户端重点查看文件/libsync/checksums.\+cpp}}


Computing and validating file checksums  


{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}filesystem.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}checksums.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}syncfileitem.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}propagatorjobs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}account.\+h\char`\"{}}\newline
{\ttfamily \#include $<$qtconcurrentrun.\+h$>$}\newline
\subsection*{命名空间}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespace_o_c_c}{O\+CC}
\end{DoxyCompactItemize}
\subsection*{函数}
\begin{DoxyCompactItemize}
\item 
Q\+Byte\+Array \hyperlink{namespace_o_c_c_a2f13fc062a188027ffc2939363bcb37f}{O\+C\+C\+::make\+Checksum\+Header} (const Q\+Byte\+Array \&checksum\+Type, const Q\+Byte\+Array \&checksum)
\begin{DoxyCompactList}\small\item\em Creates a checksum header from type and value. \end{DoxyCompactList}\item 
bool \hyperlink{namespace_o_c_c_a4d9ed0cd51d8709a9253e00f2f203cab}{O\+C\+C\+::parse\+Checksum\+Header} (const Q\+Byte\+Array \&header, Q\+Byte\+Array $\ast$type, Q\+Byte\+Array $\ast$checksum)
\begin{DoxyCompactList}\small\item\em Parses a checksum header \end{DoxyCompactList}\item 
bool \hyperlink{namespace_o_c_c_aa7010e2fa7bcdda9e53981df6d8efb3c}{O\+C\+C\+::upload\+Checksum\+Enabled} ()
\begin{DoxyCompactList}\small\item\em Checks O\+W\+N\+C\+L\+O\+U\+D\+\_\+\+D\+I\+S\+A\+B\+L\+E\+\_\+\+C\+H\+E\+C\+K\+S\+U\+M\+\_\+\+U\+P\+L\+O\+AD \end{DoxyCompactList}\item 
Q\+Byte\+Array \hyperlink{namespace_o_c_c_a6341c56b4b72b2fcc60449285f9f7c38}{O\+C\+C\+::content\+Checksum\+Type} ()
\begin{DoxyCompactList}\small\item\em Checks O\+W\+N\+C\+L\+O\+U\+D\+\_\+\+C\+O\+N\+T\+E\+N\+T\+\_\+\+C\+H\+E\+C\+K\+S\+U\+M\+\_\+\+T\+Y\+PE (default\+: S\+H\+A1) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{详细描述}
Computing and validating file checksums 

\subsubsection*{Overview }

Checksums are used in two distinct ways during synchronization\+:


\begin{DoxyItemize}
\item to guard uploads and downloads against data corruption (transmission checksum)
\item to quickly check whether the content of a file has changed to avoid redundant uploads (content checksum)
\end{DoxyItemize}

In principle both are independent and different checksumming algorithms can be used. To avoid redundant computations, it can make sense to use the same checksum algorithm though.

\subsubsection*{Transmission Checksums }

The usage of transmission checksums is currently optional and needs to be explicitly enabled by adding \textquotesingle{}transmission\+Checksum=T\+Y\+PE\textquotesingle{} to the \textquotesingle{}\mbox{[}General\mbox{]}\textquotesingle{} section of the config file.

When enabled, the checksum will be calculated on upload and sent to the server in the O\+C-\/\+Checksum header with the format \textquotesingle{}T\+Y\+PE\+:C\+H\+E\+C\+K\+S\+UM\textquotesingle{}.

On download, the header with the same name is read and if the received data does not have the expected checksum, the download is rejected.

Transmission checksums guard a specific sync action and are not stored in the database.

\subsubsection*{Content Checksums }

Sometimes the metadata of a local file changes while the content stays unchanged. Content checksums allow the sync client to avoid uploading the same data again by comparing the file\textquotesingle{}s actual checksum to the checksum stored in the database.

Content checksums are not sent to the server.

\subsubsection*{Checksum Algorithms }


\begin{DoxyItemize}
\item Adler32 (requires zlib)
\item M\+D5
\item S\+H\+A1 
\end{DoxyItemize}